{% extends 'base.html' %}

{% block title%}Application Tracker{% endblock %}

{% block header%}
    <li class="nav-item">
        <a class="nav-link" href="{{ url_for('add_record') }}">Add record</a>
    </li>
{% endblock %}

{% block content%}
    <script src="{{ url_for('static', filename='home.js') }}"></script>

    <a class="btn btn-primary" href="{{ url_for('add_record') }}">Add record</a>

    <table class="table table-striped table-hover" id="tableAppInfo">
        <thead>
            <th scope="col">Company</th>
            <th scope="col">Position/Program</th>
            <th scope="col">Hiring Status</th>
            <th scope="col">Deadline</th>
            <th scope="col">Company Type</th>
            <th scope="col">Priority</th>
            <th scope="col">Application Portal</th>
            <th scope="col">Status</th>
            <th scope="col">Comment</th>
        </thead>
        {% for row in rows %}
        <tr>
            <td class="tdComp">{{row["company"]}}</td>
            <td class="tdPos"><a href="{{ row['weblink'] }}" target="_blank">{{row["position"]}}</a></td>
            <td>{{row["posting_status"]}}</td>
            <td>{{row["deadline"]}}</td>
            <td>{{row["company_type"]}}</td>
            <td>{{row["app_priority"]}}</td>
            <td>{% if row['app_portal'] %}<a href="{{row['app_portal']}}" target="_blank">Link</a>{% endif %}</td>
            <td class="tdStatus">{{row["app_status"]}}</td>
            <td class="tdNote">{{row['note']}}</td>	
        </tr>
        {% endfor %}
    </table>
    <div class="hidden div-update-status" hidden>
        <select class="form-select update update-status" name="status" aria-label="update-status">
            <option value="None"></option>
            <option value="Ready">Ready</option>
            <option value="Ongoing">Ongoing</option>
            <option value="Submitted">Submitted</option>
            <option value="Interview">Interview</option>
            <option value="Rejected">Rejected</option>
            <option value="Offer">Offer</option>
        </select>
        <label for="update-time" class="form-label">Time updated</label>
        <input type="datetime-local" class="form-control update update-time" name="time">
        <input type="text" class="update update-company-auto" name="company" aria-label="company-hidden" hidden/>
        <input type="text" class="update update-position-auto" name="position" aria-label="position-hidden" hidden/>
        <div class="mt-3">
            <button class="btn btn-primary" onclick="updateTd('tdStatus')">Confirm</button>
            <button class="btn btn-secondary" onclick="revertTd('tdStatus')">Cancel</button>            
        </div>
    </div>

    <div class="hidden div-update-note" hidden>
        <textarea class="form-control update update-note" name = "note" aria-label="update-note"></textarea>
    </div>

    <script>
        function get_url_update() {
            return "{{ url_for('update') }}";
        }
    </script>
{% endblock %}
